2025-05-24 20:18:55.131 | INFO     | __main__:<module>:29 - Starting training script for multi-intent classification...
2025-05-24 20:18:55.131 | INFO     | __main__:<module>:32 - Step 1: Loading dataset...
2025-05-24 20:18:55.150 | INFO     | __main__:<module>:38 - Dataset loaded. Shape: (160, 5). Example label_list: [['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction']]
2025-05-24 20:18:55.150 | INFO     | __main__:<module>:41 - Step 2: Creating label map and binarizer for multi-label...
2025-05-24 20:18:55.153 | INFO     | __main__:<module>:54 - Label map and binarizer created. Number of unique labels: 8
2025-05-24 20:18:55.153 | INFO     | __main__:<module>:55 - Ordered labels for model: ['Intent_Amendment_Abstraction', 'Intent_Clause_Protect', 'Intent_Company_research', 'Intent_Comparison_LOI_Lease', 'Intent_Lease_Abstraction', 'Intent_Lease_Listings_Comparison', 'Intent_Sales_Listings_Comparison', 'Intent_Transaction_Date_navigator']
2025-05-24 20:18:55.154 | INFO     | __main__:<module>:58 - Step 3: Encoding labels (multi-hot)...
2025-05-24 20:18:55.158 | INFO     | __main__:<module>:60 - Labels multi-hot encoded. Example: {DF['labels_encoded'].head().tolist()}
2025-05-24 20:18:55.158 | INFO     | __main__:<module>:74 - Performing train-test split of the dataset (no stratification for multi-label demo)...
2025-05-24 20:18:55.166 | INFO     | __main__:<module>:80 - Dataset split. Training size: 128, Validation size: 32
2025-05-24 20:18:55.167 | INFO     | __main__:<module>:83 - Step 4: Initializing Tokenizer & Model for multi-label classification...
2025-05-24 20:18:58.034 | INFO     | __main__:<module>:93 - Tokenizer and Model (bert-base-uncased) initialized for multi-label with 8 labels.
2025-05-24 20:18:58.034 | INFO     | __main__:<module>:96 - Step 5: Defining tokenization helper and tokenizing datasets...
2025-05-24 20:18:58.190 | INFO     | __main__:<module>:116 - Datasets tokenized and formatted with multi-hot labels as type float.
2025-05-24 20:18:58.190 | INFO     | __main__:<module>:120 - Step 6: Setting up TrainingArguments & Trainer...
2025-05-24 20:18:58.190 | INFO     | __main__:<module>:129 - Calculated steps_per_epoch for eval/save: 16
2025-05-24 20:18:58.222 | INFO     | __main__:<module>:180 - TrainingArguments and Trainer configured for multi-label.
2025-05-24 20:18:58.222 | INFO     | __main__:<module>:183 - Step 7: Starting model training...
2025-05-24 20:26:58.139 | INFO     | __main__:<module>:29 - Starting training script for multi-intent classification...
2025-05-24 20:26:58.140 | INFO     | __main__:<module>:32 - Step 1: Loading dataset...
2025-05-24 20:26:58.148 | INFO     | __main__:<module>:38 - Dataset loaded. Shape: (160, 5). Example label_list: [['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction']]
2025-05-24 20:26:58.149 | INFO     | __main__:<module>:41 - Step 2: Creating label map and binarizer for multi-label...
2025-05-24 20:26:58.150 | INFO     | __main__:<module>:54 - Label map and binarizer created. Number of unique labels: 8
2025-05-24 20:26:58.151 | INFO     | __main__:<module>:55 - Ordered labels for model: ['Intent_Amendment_Abstraction', 'Intent_Clause_Protect', 'Intent_Company_research', 'Intent_Comparison_LOI_Lease', 'Intent_Lease_Abstraction', 'Intent_Lease_Listings_Comparison', 'Intent_Sales_Listings_Comparison', 'Intent_Transaction_Date_navigator']
2025-05-24 20:26:58.151 | INFO     | __main__:<module>:58 - Step 3: Encoding labels (multi-hot)...
2025-05-24 20:26:58.154 | INFO     | __main__:<module>:61 - Labels multi-hot encoded. Example: [array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32)]
2025-05-24 20:26:58.154 | INFO     | __main__:<module>:75 - Performing train-test split of the dataset (no stratification for multi-label demo)...
2025-05-24 20:26:58.157 | INFO     | __main__:<module>:81 - Dataset split. Training size: 128, Validation size: 32
2025-05-24 20:26:58.157 | INFO     | __main__:<module>:84 - Step 4: Initializing Tokenizer & Model for multi-label classification...
2025-05-24 20:27:00.271 | INFO     | __main__:<module>:94 - Tokenizer and Model (bert-base-uncased) initialized for multi-label with 8 labels.
2025-05-24 20:27:00.272 | INFO     | __main__:<module>:97 - Step 5: Defining tokenization helper and tokenizing datasets...
2025-05-24 20:27:00.398 | INFO     | __main__:<module>:117 - Datasets tokenized and formatted with multi-hot labels as type float.
2025-05-24 20:27:00.398 | INFO     | __main__:<module>:121 - Step 6: Setting up TrainingArguments & Trainer...
2025-05-24 20:27:00.400 | INFO     | __main__:<module>:130 - Calculated steps_per_epoch for eval/save: 16
2025-05-24 20:27:00.441 | INFO     | __main__:<module>:181 - TrainingArguments and Trainer configured for multi-label.
2025-05-24 20:27:00.442 | INFO     | __main__:<module>:184 - Step 7: Starting model training...
2025-05-24 20:39:09.381 | INFO     | __main__:<module>:186 - Model training completed.
2025-05-24 20:39:09.381 | INFO     | __main__:<module>:187 - Saving model and tokenizer...
2025-05-24 20:39:10.192 | INFO     | __main__:<module>:190 - Model and tokenizer saved to ./app/model.
2025-05-24 20:39:10.193 | INFO     | __main__:<module>:193 - Step 8: Evaluating model and generating report...
2025-05-24 20:39:14.349 | INFO     | __main__:<module>:204 - Classification Report (Multi-Label):
                                   precision    recall  f1-score   support

     Intent_Amendment_Abstraction       0.00      0.00      0.00         5
            Intent_Clause_Protect       0.00      0.00      0.00         3
          Intent_Company_research       0.00      0.00      0.00         3
      Intent_Comparison_LOI_Lease       0.00      0.00      0.00         4
         Intent_Lease_Abstraction       0.00      0.00      0.00         6
 Intent_Lease_Listings_Comparison       0.00      0.00      0.00         4
 Intent_Sales_Listings_Comparison       0.00      0.00      0.00         3
Intent_Transaction_Date_navigator       0.00      0.00      0.00         4

                        micro avg       0.00      0.00      0.00        32
                        macro avg       0.00      0.00      0.00        32
                     weighted avg       0.00      0.00      0.00        32
                      samples avg       0.00      0.00      0.00        32

2025-05-24 20:39:14.351 | INFO     | __main__:<module>:208 - Multi-label Confusion Matrices (one per label):
2025-05-24 20:39:14.351 | INFO     | __main__:<module>:210 - Confusion Matrix for label 'Intent_Amendment_Abstraction':
TN: 27 FP: 0
FN: 5 TP: 0
2025-05-24 20:39:14.352 | INFO     | __main__:<module>:210 - Confusion Matrix for label 'Intent_Clause_Protect':
TN: 29 FP: 0
FN: 3 TP: 0
2025-05-24 20:39:14.352 | INFO     | __main__:<module>:210 - Confusion Matrix for label 'Intent_Company_research':
TN: 29 FP: 0
FN: 3 TP: 0
2025-05-24 20:39:14.352 | INFO     | __main__:<module>:210 - Confusion Matrix for label 'Intent_Comparison_LOI_Lease':
TN: 28 FP: 0
FN: 4 TP: 0
2025-05-24 20:39:14.353 | INFO     | __main__:<module>:210 - Confusion Matrix for label 'Intent_Lease_Abstraction':
TN: 26 FP: 0
FN: 6 TP: 0
2025-05-24 20:39:14.353 | INFO     | __main__:<module>:210 - Confusion Matrix for label 'Intent_Lease_Listings_Comparison':
TN: 28 FP: 0
FN: 4 TP: 0
2025-05-24 20:39:14.354 | INFO     | __main__:<module>:210 - Confusion Matrix for label 'Intent_Sales_Listings_Comparison':
TN: 29 FP: 0
FN: 3 TP: 0
2025-05-24 20:39:14.354 | INFO     | __main__:<module>:210 - Confusion Matrix for label 'Intent_Transaction_Date_navigator':
TN: 28 FP: 0
FN: 4 TP: 0
2025-05-24 20:39:14.354 | INFO     | __main__:<module>:212 - Evaluation completed.
2025-05-24 20:39:14.355 | INFO     | __main__:<module>:213 - Training script for multi-intent classification finished.
2025-05-24 20:46:23.078 | INFO     | __main__:<module>:29 - Starting training script for multi-intent classification...
2025-05-24 20:46:23.078 | INFO     | __main__:<module>:32 - Step 1: Loading dataset...
2025-05-24 20:46:23.086 | INFO     | __main__:<module>:38 - Dataset loaded. Shape: (160, 5). Example label_list: [['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction']]
2025-05-24 20:46:23.087 | INFO     | __main__:<module>:41 - Step 2: Creating label map and binarizer for multi-label...
2025-05-24 20:46:23.088 | INFO     | __main__:<module>:54 - Label map and binarizer created. Number of unique labels: 8
2025-05-24 20:46:23.089 | INFO     | __main__:<module>:55 - Ordered labels for model: ['Intent_Amendment_Abstraction', 'Intent_Clause_Protect', 'Intent_Company_research', 'Intent_Comparison_LOI_Lease', 'Intent_Lease_Abstraction', 'Intent_Lease_Listings_Comparison', 'Intent_Sales_Listings_Comparison', 'Intent_Transaction_Date_navigator']
2025-05-24 20:46:23.089 | INFO     | __main__:<module>:58 - Step 3: Encoding labels (multi-hot)...
2025-05-24 20:46:23.094 | INFO     | __main__:<module>:61 - Labels multi-hot encoded. Example: [array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32)]
2025-05-24 20:46:23.094 | INFO     | __main__:<module>:75 - Performing train-test split of the dataset (no stratification for multi-label demo)...
2025-05-24 20:46:23.095 | INFO     | __main__:<module>:81 - Dataset split. Training size: 128, Validation size: 32
2025-05-24 20:46:23.096 | INFO     | __main__:<module>:84 - Step 4: Initializing Tokenizer & Model for multi-label classification...
2025-05-24 20:46:25.250 | INFO     | __main__:<module>:94 - Tokenizer and Model (bert-base-uncased) initialized for multi-label with 8 labels.
2025-05-24 20:46:25.250 | INFO     | __main__:<module>:97 - Step 5: Defining tokenization helper and tokenizing datasets...
2025-05-24 20:46:25.350 | INFO     | __main__:<module>:117 - Datasets tokenized and formatted with multi-hot labels as type float.
2025-05-24 20:46:25.350 | INFO     | __main__:<module>:121 - Step 6: Setting up TrainingArguments & Trainer...
2025-05-24 20:46:25.350 | INFO     | __main__:<module>:130 - Calculated steps_per_epoch for eval/save: 16
2025-05-24 20:46:25.381 | INFO     | __main__:<module>:194 - TrainingArguments and Trainer configured for multi-label.
2025-05-24 20:46:25.381 | INFO     | __main__:<module>:197 - Step 7: Starting model training...
2025-05-24 20:48:51.727 | INFO     | __main__:compute_metrics:161 - Compute_metrics call #1
2025-05-24 20:48:51.728 | INFO     | __main__:compute_metrics:162 - Debug eval: Sample true labels (first 2): [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
2025-05-24 20:48:51.728 | INFO     | __main__:compute_metrics:163 - Debug eval: Sample logits (first 2): [[-0.9250466823577881, -0.9065163135528564, -0.47329989075660706, -1.0303112268447876, -0.6921630501747131, -1.1255422830581665, -0.5971758961677551, -1.0146061182022095], [-0.6243789792060852, -0.904757022857666, -0.764863133430481, -0.7451267242431641, -0.7079951763153076, -0.7472941875457764, -0.730055034160614, -0.9475700259208679]]
2025-05-24 20:48:51.729 | INFO     | __main__:compute_metrics:164 - Debug eval: Sample probabilities (first 2): [[0.2839307188987732, 0.2877132296562195, 0.3838355243206024, 0.2630237638950348, 0.3335520923137665, 0.2449847161769867, 0.35499003529548645, 0.2660793662071228], [0.34878620505332947, 0.28807389736175537, 0.3175913691520691, 0.3218840956687927, 0.3300420045852661, 0.3214111626148224, 0.32518264651298523, 0.27937376499176025]]
2025-05-24 21:00:11.029 | INFO     | __main__:compute_metrics:161 - Compute_metrics call #6
2025-05-24 21:00:11.030 | INFO     | __main__:compute_metrics:162 - Debug eval: Sample true labels (first 2): [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
2025-05-24 21:00:11.031 | INFO     | __main__:compute_metrics:163 - Debug eval: Sample logits (first 2): [[-1.189225673675537, -1.2147424221038818, -2.0918216705322266, -1.7193217277526855, -1.886592149734497, -1.5962016582489014, -1.997878074645996, -2.1398136615753174], [-0.9026561975479126, -1.4579064846038818, -2.257288932800293, -1.537020206451416, -1.5572060346603394, -1.2958576679229736, -1.8417208194732666, -2.0179808139801025]]
2025-05-24 21:00:11.031 | INFO     | __main__:compute_metrics:164 - Debug eval: Sample probabilities (first 2): [[0.2333974838256836, 0.22886303067207336, 0.10989426076412201, 0.15195855498313904, 0.13163352012634277, 0.16851314902305603, 0.11942588537931442, 0.10528694093227386], [0.288504958152771, 0.18878774344921112, 0.09472259134054184, 0.17696885764598846, 0.17404793202877045, 0.21486300230026245, 0.13684789836406708, 0.11732794344425201]]
2025-05-24 21:20:09.530 | INFO     | __main__:<module>:199 - Model training completed.
2025-05-24 21:20:09.530 | INFO     | __main__:<module>:200 - Saving model and tokenizer...
2025-05-24 21:20:10.238 | INFO     | __main__:<module>:203 - Model and tokenizer saved to ./app/model.
2025-05-24 21:20:10.239 | INFO     | __main__:<module>:206 - Step 8: Evaluating model and generating report...
2025-05-24 21:20:18.556 | INFO     | __main__:compute_metrics:161 - Compute_metrics call #11
2025-05-24 21:20:18.556 | INFO     | __main__:compute_metrics:162 - Debug eval: Sample true labels (first 2): [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
2025-05-24 21:20:18.556 | INFO     | __main__:compute_metrics:163 - Debug eval: Sample logits (first 2): [[-1.0081453323364258, -1.2468392848968506, -2.2702460289001465, -1.859259843826294, -1.9924736022949219, -1.6737736463546753, -2.2298645973205566, -2.253020763397217], [-0.6667748689651489, -1.619210124015808, -2.4438071250915527, -1.7246544361114502, -1.6164458990097046, -1.3763788938522339, -2.062643051147461, -1.9849995374679565]]
2025-05-24 21:20:18.558 | INFO     | __main__:compute_metrics:164 - Debug eval: Sample probabilities (first 2): [[0.2673429548740387, 0.22324776649475098, 0.09361733496189117, 0.1347893625497818, 0.11999540776014328, 0.157921701669693, 0.09710051119327545, 0.09508921951055527], [0.3392193913459778, 0.16531383991241455, 0.0798926055431366, 0.15127260982990265, 0.16569560766220093, 0.20159119367599487, 0.1127810925245285, 0.12078690528869629]]
2025-05-24 21:20:18.571 | INFO     | __main__:<module>:216 - Final Eval: Sample true labels (first 3): [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]]
2025-05-24 21:20:18.572 | INFO     | __main__:<module>:217 - Final Eval: Sample logits (first 3): [[-1.0081453323364258, -1.2468392848968506, -2.2702460289001465, -1.859259843826294, -1.9924736022949219, -1.6737736463546753, -2.2298645973205566, -2.253020763397217], [-0.6667748689651489, -1.619210124015808, -2.4438071250915527, -1.7246544361114502, -1.6164458990097046, -1.3763788938522339, -2.062643051147461, -1.9849995374679565], [-2.3755764961242676, -2.2388172149658203, -2.2970330715179443, -1.929715871810913, -1.4904735088348389, -1.1075403690338135, -0.55296391248703, -2.4351673126220703]]
2025-05-24 21:20:18.573 | INFO     | __main__:<module>:218 - Final Eval: Sample probabilities (first 3): [[0.2673429548740387, 0.22324776649475098, 0.09361733496189117, 0.1347893625497818, 0.11999540776014328, 0.157921701669693, 0.09710051119327545, 0.09508921951055527], [0.3392193913459778, 0.16531383991241455, 0.0798926055431366, 0.15127260982990265, 0.16569560766220093, 0.20159119367599487, 0.1127810925245285, 0.12078690528869629], [0.0850541740655899, 0.09631843864917755, 0.09136898070573807, 0.12678202986717224, 0.18385066092014313, 0.24832972884178162, 0.3651770353317261, 0.08053003251552582]]
2025-05-24 21:20:18.573 | INFO     | __main__:<module>:219 - Final Eval: Sample predicted_multi_hot (first 3): [[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]]
2025-05-24 21:20:18.589 | INFO     | __main__:<module>:224 - Classification Report (Multi-Label):
                                   precision    recall  f1-score   support

     Intent_Amendment_Abstraction       0.00      0.00      0.00         5
            Intent_Clause_Protect       0.00      0.00      0.00         3
          Intent_Company_research       0.00      0.00      0.00         3
      Intent_Comparison_LOI_Lease       1.00      0.25      0.40         4
         Intent_Lease_Abstraction       0.00      0.00      0.00         6
 Intent_Lease_Listings_Comparison       0.00      0.00      0.00         4
 Intent_Sales_Listings_Comparison       0.00      0.00      0.00         3
Intent_Transaction_Date_navigator       1.00      0.50      0.67         4

                        micro avg       1.00      0.09      0.17        32
                        macro avg       0.25      0.09      0.13        32
                     weighted avg       0.25      0.09      0.13        32
                      samples avg       0.09      0.09      0.09        32

2025-05-24 21:20:18.592 | INFO     | __main__:<module>:228 - Multi-label Confusion Matrices (one per label):
2025-05-24 21:20:18.595 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Amendment_Abstraction':
TN: 27 FP: 0
FN: 5 TP: 0
2025-05-24 21:20:18.596 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Clause_Protect':
TN: 29 FP: 0
FN: 3 TP: 0
2025-05-24 21:20:18.597 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Company_research':
TN: 29 FP: 0
FN: 3 TP: 0
2025-05-24 21:20:18.597 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Comparison_LOI_Lease':
TN: 28 FP: 0
FN: 3 TP: 1
2025-05-24 21:20:18.597 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Lease_Abstraction':
TN: 26 FP: 0
FN: 6 TP: 0
2025-05-24 21:20:18.598 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Lease_Listings_Comparison':
TN: 28 FP: 0
FN: 4 TP: 0
2025-05-24 21:20:18.598 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Sales_Listings_Comparison':
TN: 29 FP: 0
FN: 3 TP: 0
2025-05-24 21:20:18.598 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Transaction_Date_navigator':
TN: 28 FP: 0
FN: 2 TP: 2
2025-05-24 21:20:18.599 | INFO     | __main__:<module>:232 - Evaluation completed.
2025-05-24 21:20:18.599 | INFO     | __main__:<module>:233 - Training script for multi-intent classification finished.
2025-05-24 21:41:39.114 | INFO     | __main__:<module>:29 - Starting training script for multi-intent classification...
2025-05-24 21:41:39.115 | INFO     | __main__:<module>:32 - Step 1: Loading dataset...
2025-05-24 21:41:39.123 | INFO     | __main__:<module>:38 - Dataset loaded. Shape: (160, 5). Example label_list: [['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction'], ['Intent_Lease_Abstraction']]
2025-05-24 21:41:39.123 | INFO     | __main__:<module>:41 - Step 2: Creating label map and binarizer for multi-label...
2025-05-24 21:41:39.125 | INFO     | __main__:<module>:54 - Label map and binarizer created. Number of unique labels: 8
2025-05-24 21:41:39.125 | INFO     | __main__:<module>:55 - Ordered labels for model: ['Intent_Amendment_Abstraction', 'Intent_Clause_Protect', 'Intent_Company_research', 'Intent_Comparison_LOI_Lease', 'Intent_Lease_Abstraction', 'Intent_Lease_Listings_Comparison', 'Intent_Sales_Listings_Comparison', 'Intent_Transaction_Date_navigator']
2025-05-24 21:41:39.126 | INFO     | __main__:<module>:58 - Step 3: Encoding labels (multi-hot)...
2025-05-24 21:41:39.130 | INFO     | __main__:<module>:61 - Labels multi-hot encoded. Example: [array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32), array([0., 0., 0., 0., 1., 0., 0., 0.], dtype=float32)]
2025-05-24 21:41:39.130 | INFO     | __main__:<module>:75 - Performing train-test split of the dataset (no stratification for multi-label demo)...
2025-05-24 21:41:39.134 | INFO     | __main__:<module>:81 - Dataset split. Training size: 128, Validation size: 32
2025-05-24 21:41:39.134 | INFO     | __main__:<module>:84 - Step 4: Initializing Tokenizer & Model for multi-label classification...
2025-05-24 21:41:41.486 | INFO     | __main__:<module>:94 - Tokenizer and Model (bert-base-uncased) initialized for multi-label with 8 labels.
2025-05-24 21:41:41.488 | INFO     | __main__:<module>:97 - Step 5: Defining tokenization helper and tokenizing datasets...
2025-05-24 21:41:41.645 | INFO     | __main__:<module>:117 - Datasets tokenized and formatted with multi-hot labels as type float.
2025-05-24 21:41:41.646 | INFO     | __main__:<module>:121 - Step 6: Setting up TrainingArguments & Trainer...
2025-05-24 21:41:41.647 | INFO     | __main__:<module>:130 - Calculated steps_per_epoch for eval/save: 16
2025-05-24 21:41:41.678 | INFO     | __main__:<module>:194 - TrainingArguments and Trainer configured for multi-label.
2025-05-24 21:41:41.679 | INFO     | __main__:<module>:197 - Step 7: Starting model training...
2025-05-24 21:43:56.685 | INFO     | __main__:compute_metrics:161 - Compute_metrics call #1
2025-05-24 21:43:56.685 | INFO     | __main__:compute_metrics:162 - Debug eval: Sample true labels (first 2): [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
2025-05-24 21:43:56.686 | INFO     | __main__:compute_metrics:163 - Debug eval: Sample logits (first 2): [[-0.7859503030776978, -1.115464448928833, -0.9510303735733032, -0.7806345224380493, -1.0140879154205322, -1.0560106039047241, -0.5422024726867676, -0.8034267425537109], [-0.8163454532623291, -1.25796377658844, -1.143691062927246, -0.7921682596206665, -0.9638753533363342, -1.111177682876587, -0.41555067896842957, -0.7041726112365723]]
2025-05-24 21:43:56.686 | INFO     | __main__:compute_metrics:164 - Debug eval: Sample probabilities (first 2): [[0.3130388855934143, 0.24685357511043549, 0.27867764234542847, 0.31418314576148987, 0.2661806046962738, 0.2580725848674774, 0.36767539381980896, 0.3092930018901825], [0.30653995275497437, 0.2213246077299118, 0.24164333939552307, 0.31170329451560974, 0.2761029601097107, 0.2476513832807541, 0.39758193492889404, 0.3308877646923065]]
2025-05-24 21:59:15.121 | INFO     | __main__:compute_metrics:161 - Compute_metrics call #6
2025-05-24 21:59:15.122 | INFO     | __main__:compute_metrics:162 - Debug eval: Sample true labels (first 2): [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
2025-05-24 21:59:15.123 | INFO     | __main__:compute_metrics:163 - Debug eval: Sample logits (first 2): [[-0.2629084587097168, -0.7422993183135986, -1.9519075155258179, -1.8680663108825684, -1.7777296304702759, -1.5372519493103027, -2.0875134468078613, -2.411848783493042], [-0.28737127780914307, -1.4079761505126953, -2.1215286254882812, -1.7582844495773315, -1.7888166904449463, -1.5600417852401733, -1.9153176546096802, -2.1774892807006836]]
2025-05-24 21:59:15.123 | INFO     | __main__:compute_metrics:164 - Debug eval: Sample probabilities (first 2): [[0.43464890122413635, 0.322501540184021, 0.12434552609920502, 0.13376562297344208, 0.14458370208740234, 0.1769351214170456, 0.11031638830900192, 0.08227361738681793], [0.428647518157959, 0.19655346870422363, 0.10702189058065414, 0.1470053344964981, 0.14321786165237427, 0.173640638589859, 0.12838461995124817, 0.10179024934768677]]
2025-05-24 22:10:27.238 | INFO     | __main__:compute_metrics:161 - Compute_metrics call #11
2025-05-24 22:10:27.238 | INFO     | __main__:compute_metrics:162 - Debug eval: Sample true labels (first 2): [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
2025-05-24 22:10:27.239 | INFO     | __main__:compute_metrics:163 - Debug eval: Sample logits (first 2): [[0.7393988370895386, -1.0993623733520508, -2.3509371280670166, -2.171351909637451, -1.9112954139709473, -1.8645827770233154, -2.2746243476867676, -2.739656925201416], [0.895868182182312, -1.8152517080307007, -2.386840343475342, -1.9485218524932861, -1.6285152435302734, -1.8855788707733154, -2.191277503967285, -2.3865392208099365]]
2025-05-24 22:10:27.239 | INFO     | __main__:compute_metrics:164 - Debug eval: Sample probabilities (first 2): [[0.6768643856048584, 0.24985937774181366, 0.0869913101196289, 0.10235275328159332, 0.12883538007736206, 0.1341697871685028, 0.09324648231267929, 0.06067345663905144], [0.7100996971130371, 0.14000460505485535, 0.08418170362710953, 0.12471464276313782, 0.16403387486934662, 0.13174937665462494, 0.10053651034832001, 0.08420491963624954]]
2025-05-24 22:21:23.864 | INFO     | __main__:compute_metrics:161 - Compute_metrics call #16
2025-05-24 22:21:23.864 | INFO     | __main__:compute_metrics:162 - Debug eval: Sample true labels (first 2): [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
2025-05-24 22:21:23.864 | INFO     | __main__:compute_metrics:163 - Debug eval: Sample logits (first 2): [[0.9252183437347412, -1.7372245788574219, -2.5829379558563232, -2.3887815475463867, -2.1960840225219727, -2.087963104248047, -2.473933458328247, -2.900444507598877], [1.128367304801941, -2.216369152069092, -2.467930793762207, -2.1589040756225586, -1.8397600650787354, -2.034719228744507, -2.297924041748047, -2.5126986503601074]]
2025-05-24 22:21:23.865 | INFO     | __main__:compute_metrics:164 - Debug eval: Sample probabilities (first 2): [[0.7161042094230652, 0.14966581761837006, 0.07024461030960083, 0.08403217047452927, 0.10010270029306412, 0.11027225106954575, 0.07770586758852005, 0.05213159695267677], [0.7555375099182129, 0.09829013794660568, 0.07813715934753418, 0.10350209474563599, 0.13707968592643738, 0.11560554057359695, 0.0912950411438942, 0.0749727413058281]]
2025-05-24 22:29:45.370 | INFO     | __main__:<module>:199 - Model training completed.
2025-05-24 22:29:45.371 | INFO     | __main__:<module>:200 - Saving model and tokenizer...
2025-05-24 22:29:46.081 | INFO     | __main__:<module>:203 - Model and tokenizer saved to ./app/model.
2025-05-24 22:29:46.082 | INFO     | __main__:<module>:206 - Step 8: Evaluating model and generating report...
2025-05-24 22:29:51.663 | INFO     | __main__:compute_metrics:161 - Compute_metrics call #21
2025-05-24 22:29:51.663 | INFO     | __main__:compute_metrics:162 - Debug eval: Sample true labels (first 2): [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
2025-05-24 22:29:51.664 | INFO     | __main__:compute_metrics:163 - Debug eval: Sample logits (first 2): [[0.9813945293426514, -1.7129851579666138, -2.63364315032959, -2.4437828063964844, -2.2293920516967773, -2.1454286575317383, -2.5410027503967285, -2.9957869052886963], [1.1974740028381348, -2.216470241546631, -2.545665740966797, -2.2318809032440186, -1.8782904148101807, -2.097661256790161, -2.359023332595825, -2.6254937648773193]]
2025-05-24 22:29:51.664 | INFO     | __main__:compute_metrics:164 - Debug eval: Sample probabilities (first 2): [[0.7273848652839661, 0.15277692675590515, 0.06700433790683746, 0.07989439368247986, 0.09714194387197495, 0.10475917905569077, 0.07303325831890106, 0.04761657118797302], [0.768075168132782, 0.09828118234872818, 0.07271819561719894, 0.09692388772964478, 0.13258536159992218, 0.10932434350252151, 0.08635122328996658, 0.06751559674739838]]
2025-05-24 22:29:51.682 | INFO     | __main__:<module>:216 - Final Eval: Sample true labels (first 3): [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]]
2025-05-24 22:29:51.683 | INFO     | __main__:<module>:217 - Final Eval: Sample logits (first 3): [[0.9813945293426514, -1.7129851579666138, -2.63364315032959, -2.4437828063964844, -2.2293920516967773, -2.1454286575317383, -2.5410027503967285, -2.9957869052886963], [1.1974740028381348, -2.216470241546631, -2.545665740966797, -2.2318809032440186, -1.8782904148101807, -2.097661256790161, -2.359023332595825, -2.6254937648773193], [-2.9238855838775635, -2.4765353202819824, -3.492140531539917, -2.8595056533813477, -2.2247233390808105, -0.4924493134021759, -0.5185247659683228, -3.4059977531433105]]
2025-05-24 22:29:51.683 | INFO     | __main__:<module>:218 - Final Eval: Sample probabilities (first 3): [[0.7273848652839661, 0.15277692675590515, 0.06700433790683746, 0.07989439368247986, 0.09714194387197495, 0.10475917905569077, 0.07303325831890106, 0.04761657118797302], [0.768075168132782, 0.09828118234872818, 0.07271819561719894, 0.09692388772964478, 0.13258536159992218, 0.10932434350252151, 0.08635122328996658, 0.06751559674739838], [0.05098536238074303, 0.07751960307359695, 0.02953668311238289, 0.05419202893972397, 0.09755219519138336, 0.3793167471885681, 0.3731972575187683, 0.03210854530334473]]
2025-05-24 22:29:51.685 | INFO     | __main__:<module>:219 - Final Eval: Sample predicted_multi_hot (first 3): [[1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]]
2025-05-24 22:29:51.720 | INFO     | __main__:<module>:224 - Classification Report (Multi-Label):
                                   precision    recall  f1-score   support

     Intent_Amendment_Abstraction       1.00      1.00      1.00         5
            Intent_Clause_Protect       1.00      1.00      1.00         3
          Intent_Company_research       1.00      1.00      1.00         3
      Intent_Comparison_LOI_Lease       1.00      1.00      1.00         4
         Intent_Lease_Abstraction       1.00      0.67      0.80         6
 Intent_Lease_Listings_Comparison       1.00      0.50      0.67         4
 Intent_Sales_Listings_Comparison       1.00      1.00      1.00         3
Intent_Transaction_Date_navigator       1.00      0.75      0.86         4

                        micro avg       1.00      0.84      0.92        32
                        macro avg       1.00      0.86      0.92        32
                     weighted avg       1.00      0.84      0.90        32
                      samples avg       0.84      0.84      0.84        32

2025-05-24 22:29:51.723 | INFO     | __main__:<module>:228 - Multi-label Confusion Matrices (one per label):
2025-05-24 22:29:51.724 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Amendment_Abstraction':
TN: 27 FP: 0
FN: 0 TP: 5
2025-05-24 22:29:51.725 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Clause_Protect':
TN: 29 FP: 0
FN: 0 TP: 3
2025-05-24 22:29:51.725 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Company_research':
TN: 29 FP: 0
FN: 0 TP: 3
2025-05-24 22:29:51.726 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Comparison_LOI_Lease':
TN: 28 FP: 0
FN: 0 TP: 4
2025-05-24 22:29:51.726 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Lease_Abstraction':
TN: 26 FP: 0
FN: 2 TP: 4
2025-05-24 22:29:51.726 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Lease_Listings_Comparison':
TN: 28 FP: 0
FN: 2 TP: 2
2025-05-24 22:29:51.727 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Sales_Listings_Comparison':
TN: 29 FP: 0
FN: 0 TP: 3
2025-05-24 22:29:51.727 | INFO     | __main__:<module>:230 - Confusion Matrix for label 'Intent_Transaction_Date_navigator':
TN: 28 FP: 0
FN: 1 TP: 3
2025-05-24 22:29:51.728 | INFO     | __main__:<module>:232 - Evaluation completed.
2025-05-24 22:29:51.728 | INFO     | __main__:<module>:233 - Training script for multi-intent classification finished.
